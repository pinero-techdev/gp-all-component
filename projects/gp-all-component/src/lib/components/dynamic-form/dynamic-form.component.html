<form *ngIf="dataLoaded" [formGroup]="form" (ngSubmit)="onSubmitEvent($event)">
  <div class="p-grid">
    <ng-template ngFor let-field [ngForOf]="metadata?.fields">
      <ng-template [ngIf]="field.isVisible(!isEditing ? 'edit' : 'add')">
        <div
          class="field-wrapper p-col-12"
          [ngClass]="{
            'type-checkbox':
              field.displayInfo.displayType === displayType.NULLABLE_CHECKBOX ||
              field.displayInfo.displayType === displayType.CHECKBOX,
            'p-lg-6 double-col': !config || config.cols > 1
          }"
        >
          <label
            *ngIf="field.displayInfo && field.displayInfo.fieldLabel"
            [attr.for]="field?.fieldName"
          >
            <span *ngIf="field.notNull">*</span>
            {{ field.displayInfo.fieldLabel }}
          </label>
          <gp-dynamic-field
            [field]="field"
            [data]="data"
            [value]="(form?.controls)[(field?.fieldName)].value"
            [relatedFields]="relatedFields ? relatedFields[(field?.fieldName)] : null"
            (onChange)="onChangeEvent($event)"
          ></gp-dynamic-field>
          <gp-control-error [form]="form" [fieldName]="field?.fieldName"></gp-control-error>
        </div>
      </ng-template>
    </ng-template>
  </div>

  <div class="buttons-group-wrapper">
    <p class="label-mandatory">{{ locale.FIELDS_MANDATORY_ASTERISK }}</p>
    <div class="buttons-group-left"
      ><gp-button
        [label]="locale.CANCEL"
        (onClickEvent)="onCancelEvent($event)"
        [severity]="'danger'"
      ></gp-button
    ></div>
    <div class="buttons-group-right">
      <gp-button
        *ngIf="isEditing && config.canDelete"
        [label]="locale.REMOVE"
        (onClickEvent)="onDeleteEvent($event)"
        [severity]="'dangerGhost'"
      ></gp-button>
      <gp-button
        *ngIf="(isEditing && config.canEdit) || (!isEditing && config.canAdd)"
        [label]="locale.SAVE"
        buttonType="submit"
        [disabled]="!form.dirty || !form.valid"
      ></gp-button>
    </div>
  </div>
</form>
